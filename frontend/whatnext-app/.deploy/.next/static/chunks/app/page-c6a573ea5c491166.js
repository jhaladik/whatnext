(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{790:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});let o=(0,s(9946).A)("waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]])},844:(e,t,s)=>{"use strict";s.d(t,{W:()=>a});var o=s(5453),i=s(6786),n=s(8897);let a=(0,o.v)()((0,i.lt)((0,i.Zr)((e,t)=>({sessionId:null,domain:"movies",questionFlow:"standard",questions:[],currentQuestionIndex:0,answers:{},recommendations:[],moment:null,validation:null,emotionalProfile:null,isLoading:!1,error:null,startSession:async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("[Store] Starting session with options:",t),e({isLoading:!0,error:null});try{console.log("[Store] Calling API...");let s=await n.F.startSession(t);console.log("[Store] API Response:",s),sessionStorage.setItem("whatnext_session_id",s.sessionId),sessionStorage.setItem("whatnext_session_data",JSON.stringify({questions:[s.question],domain:s.domain,flowType:s.flowType})),console.log("[Store] Saved to sessionStorage"),e({sessionId:s.sessionId,questions:[s.question],currentQuestionIndex:0,domain:s.domain,questionFlow:s.flowType,isLoading:!1,recommendations:[],answers:{},moment:null,validation:null,emotionalProfile:null}),console.log("[Store] State updated successfully")}catch(t){throw console.error("[Store] Error:",t),e({error:t.message,isLoading:!1}),t}},submitAnswer:async(s,o,i)=>{e({isLoading:!0});try{let a=await n.F.submitAnswer(s,o,i),{answers:r,currentQuestionIndex:l}=t();if(e({answers:{...r,[s]:o},currentQuestionIndex:l+1,isLoading:!1}),"recommendations"===a.type)e({recommendations:a.recommendations,moment:a.moment,validation:a.validation});else if(a.question){let{questions:s}=t();s.find(e=>e.id===a.question.id)||e({questions:[...s,a.question]})}}catch(t){e({error:t.message,isLoading:!1})}},refineRecommendations:async s=>{e({isLoading:!0});try{let t=await n.F.refineRecommendations(s);e({recommendations:t.recommendations,isLoading:!1})}catch(s){s.message.includes("401")||s.message.includes("expired")?(t().reset(),window.location.href="/"):e({error:s.message,isLoading:!1})}},quickAdjust:async s=>{e({isLoading:!0});try{let t=await n.F.quickAdjust(s);e({recommendations:t.recommendations,isLoading:!1})}catch(s){s.message.includes("401")||s.message.includes("expired")?(t().reset(),window.location.href="/"):e({error:s.message,isLoading:!1})}},validateMoment:async e=>{try{await n.F.validateMoment("overall_impression",e)}catch(e){console.error("Failed to validate moment:",e)}},trackInteraction:async(e,t)=>{console.log("[Interaction] ".concat(t," on movie ").concat(e))},loadFromStorage:t=>{var s;t.sessionId&&n.F.setSessionId(t.sessionId),e({sessionId:t.sessionId||null,recommendations:t.recommendations||[],moment:t.moment||null,validation:t.validation||null,emotionalProfile:t.emotionalProfile||null,isLoading:!1,error:null}),console.log("[Store] Loaded data from storage:",{sessionId:t.sessionId,recommendationsCount:(null==(s=t.recommendations)?void 0:s.length)||0})},reset:()=>{n.F.clearSession(),sessionStorage.removeItem("whatnext_session_id"),sessionStorage.removeItem("whatnext_session_data"),console.log("[Store] Cleared sessionStorage on reset"),e({sessionId:null,questions:[],currentQuestionIndex:0,answers:{},recommendations:[],moment:null,validation:null,emotionalProfile:null,isLoading:!1,error:null})}}),{name:"recommendation-storage",partialize:e=>({sessionId:e.sessionId})})))},4186:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});let o=(0,s(9946).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},8893:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var o=s(5155),i=s(2115),n=s(5695),a=s(8274),r=s(844),l=s(3311),c=s(9946);let d=(0,c.A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var m=s(790);let u=(0,c.A)("dice-1",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M12 12h.01",key:"1mp3jc"}]]),h=(0,c.A)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]);var y=s(4186);function g(e){let{onFlowSelected:t}=e,[s,n]=(0,i.useState)(""),[c,g]=(0,i.useState)("afternoon"),[p,x]=(0,i.useState)(!1),[f,w]=(0,i.useState)(null),{startSession:v}=(0,r.W)();(0,i.useEffect)(()=>{let e=new Date().getHours();e>=5&&e<12?(g("morning"),n("Good morning! Ready to find your perfect watch?")):e>=12&&e<17?(g("afternoon"),n("Good afternoon! What are you in the mood for?")):e>=17&&e<22?(g("evening"),n("Good evening! Let's find something perfect for tonight")):(g("lateNight"),n("Late night viewing? Let's find something perfect"))},[]);let b=[{id:"standard",title:"Standard",description:"5 thoughtful questions",icon:l.A,time:"30 seconds",color:"from-purple-400 to-purple-600"},{id:"quick",title:"Quick Pick",description:"3 quick questions",icon:d,time:"15 seconds",color:"from-yellow-400 to-orange-500"},{id:"deep",title:"Deep Dive",description:"7 detailed questions",icon:m.A,time:"1 minute",color:"from-blue-400 to-indigo-600"},{id:"surprise",title:"Surprise Me",description:"Creative questions",icon:u,time:"30 seconds",color:"from-pink-400 to-rose-600"},{id:"visual",title:"Visual Mood",description:"Choose by images",icon:h,time:"10 seconds",color:"from-green-400 to-teal-600"}],j=async e=>{console.log("=== Starting session ==="),console.log("Flow type:",e),console.log("Time context:",c),x(!0),w(null);try{console.log("Calling startSession..."),await v({questionFlow:e,context:{timeOfDay:c}}),console.log("Session started successfully!"),console.log("Calling onFlowSelected to navigate..."),t()}catch(e){console.error("Failed to start session:",e),w(e.message||"Failed to start session"),x(!1)}};return(0,o.jsxs)(a.P.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen flex flex-col items-center justify-center p-8",children:[(0,o.jsxs)(a.P.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6},className:"mb-8",children:[(0,o.jsx)("h1",{className:"text-6xl md:text-8xl font-bold text-gradient mb-2",children:"WhatNext"}),(0,o.jsx)("p",{className:"text-center text-gray-600",children:"Movie recommendations that understand you"})]}),(0,o.jsx)(a.P.h2,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},className:"text-2xl md:text-3xl font-semibold mb-4 text-center text-gray-800",children:s}),(0,o.jsx)(a.P.p,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},className:"text-lg text-gray-600 mb-12 text-center max-w-2xl",children:"Choose how you'd like to find your next movie. Each path is designed to understand your current mood and preferences."}),f&&(0,o.jsxs)(a.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:[(0,o.jsx)("p",{className:"font-semibold",children:"Error:"}),(0,o.jsx)("p",{children:f})]}),p&&(0,o.jsxs)(a.P.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-6 text-center",children:[(0,o.jsxs)("div",{className:"loading-dots flex justify-center space-x-2 mb-2",children:[(0,o.jsx)("span",{className:"w-3 h-3 bg-purple-500 rounded-full animate-bounce"}),(0,o.jsx)("span",{className:"w-3 h-3 bg-purple-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,o.jsx)("span",{className:"w-3 h-3 bg-purple-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),(0,o.jsx)("p",{className:"text-gray-600",children:"Starting your session..."})]}),(0,o.jsx)(a.P.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 max-w-6xl w-full",children:b.map((e,t)=>{let s=e.icon;return(0,o.jsxs)(a.P.button,{whileHover:{scale:1.05,y:-5},whileTap:{scale:.95},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5+.1*t},onClick:()=>j(e.id),disabled:p,className:"group relative p-6 bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden ".concat(p?"opacity-50 cursor-not-allowed":""),children:[(0,o.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br ".concat(e.color," opacity-0 group-hover:opacity-10 transition-opacity duration-300")}),(0,o.jsx)("div",{className:"mb-4 p-3 bg-gradient-to-br ".concat(e.color," rounded-xl inline-block"),children:(0,o.jsx)(s,{className:"w-8 h-8 text-white"})}),(0,o.jsx)("h3",{className:"text-xl font-bold mb-2 text-gray-800",children:e.title}),(0,o.jsx)("p",{className:"text-gray-600 text-sm mb-3",children:e.description}),(0,o.jsxs)("div",{className:"flex items-center justify-center text-xs text-gray-500",children:[(0,o.jsx)(y.A,{className:"w-3 h-3 mr-1"}),e.time]})]},e.id)})}),(0,o.jsxs)(a.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"mt-16 text-center text-sm text-gray-500",children:[(0,o.jsx)("p",{children:"Powered by AI â€¢ Personalized for you"}),(0,o.jsx)("p",{className:"mt-2 text-xs",children:"Check console for debug info"})]})]})}function p(){let e=(0,n.useRouter)(),{sessionId:t,reset:s}=(0,r.W)();return(0,i.useEffect)(()=>{!sessionStorage.getItem("whatnext_session_id")&&t&&(console.log("[HomePage] No stored session, resetting store"),s())},[]),(0,o.jsx)("div",{className:"min-h-screen",children:(0,o.jsx)(g,{onFlowSelected:()=>{console.log("[HomePage] Navigating to questions..."),setTimeout(()=>{e.push("/questions")},100)}})})}},8897:(e,t,s)=>{"use strict";s.d(t,{F:()=>i});class o{async startSession(e){console.log("[API] Starting session with URL:","".concat(this.baseURL,"/api/movies/start")),console.log("[API] Options:",e);let t=await fetch("".concat(this.baseURL,"/api/movies/start"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e||{})});if(console.log("[API] Response status:",t.status),!t.ok)throw console.error("[API] Error response:",await t.text()),Error("Failed to start session: ".concat(t.statusText));let s=await t.json();return console.log("[API] Response data:",s),this.sessionId=s.sessionId,s}async submitAnswer(e,t,s){if(!this.sessionId)throw Error("No active session");let o=await fetch("".concat(this.baseURL,"/api/movies/answer/").concat(this.sessionId),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({questionId:e,answer:t,responseTime:s})});if(!o.ok)throw Error("Failed to submit answer: ".concat(o.statusText));return o.json()}async refineRecommendations(e,t){if(!this.sessionId)throw Error("No active session");let s=await fetch("".concat(this.baseURL,"/api/movies/refine/").concat(this.sessionId),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({feedback:e,action:t})});if(!s.ok)throw Error("Failed to refine recommendations: ".concat(s.statusText));return s.json()}async quickAdjust(e){if(!this.sessionId)throw Error("No active session");let t=await fetch("".concat(this.baseURL,"/api/movies/adjust/").concat(this.sessionId),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adjustmentType:e})});if(!t.ok)throw Error("Failed to adjust: ".concat(t.statusText));return t.json()}async validateMoment(e,t){if(!this.sessionId)throw Error("No active session");let s=await fetch("".concat(this.baseURL,"/api/movies/validate/").concat(this.sessionId),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({feedbackType:e,response:t})});if(!s.ok)throw Error("Failed to validate moment: ".concat(s.statusText));return s.json()}async getMomentSummary(){if(!this.sessionId)throw Error("No active session");let e=await fetch("".concat(this.baseURL,"/api/movies/moment/").concat(this.sessionId));if(!e.ok)throw Error("Failed to get moment summary: ".concat(e.statusText));return e.json()}async trackInteraction(e,t,s){if(!this.sessionId)throw Error("No active session");let o=await fetch("".concat(this.baseURL,"/api/movies/interaction/").concat(this.sessionId),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({movieId:e,interactionType:t,metadata:s})});if(!o.ok)throw Error("Failed to track interaction: ".concat(o.statusText));return o.json()}async getMovieDetails(e){let t=await fetch("".concat(this.baseURL,"/api/movies/").concat(e));if(!t.ok)throw Error("Failed to get movie details: ".concat(t.statusText));return t.json()}async getAnalytics(e){let t=await fetch("".concat(this.baseURL,"/api/analytics/").concat(e));if(!t.ok)throw Error("Failed to get analytics: ".concat(t.statusText));return t.json()}setSessionId(e){this.sessionId=e}getSessionId(){return this.sessionId}clearSession(){this.sessionId=null}constructor(){this.sessionId=null,this.baseURL="",console.log("[API] Using Pages Functions (same domain)")}}let i=new o},9279:(e,t,s)=>{Promise.resolve().then(s.bind(s,8893))}},e=>{e.O(0,[297,441,964,358],()=>e(e.s=9279)),_N_E=e.O()}]);